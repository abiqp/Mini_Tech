<ng-container *ngIf="cartService.cart$ | async as cart">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
      
      <div *ngIf="cart.items.length === 0" class="alert alert-warning">
        Tu carrito está vacío. <a routerLink="/productos">Ir a productos</a>.
      </div>

      <div *ngIf="cart.items.length > 0" class="card p-4 shadow-sm">
        <h1 class="h5">Checkout</h1>
        <p class="">Confirma tu compra para finalizar.</p>
        <hr>
        <div class="d-flex justify-content-between h4">
          <span>Total a pagar</span>
          <strong>{{ cartService.getTotal() | currency }}</strong>
        </div>
        <!-- El botón ahora llama al nuevo método -->
        <button class="btn btn-primary w-100 mt-3" (click)="startCheckoutProcess()">
          Confirmar y Pagar
        </button>
      </div>

    </div>
  </div>
</ng-container>

<app-checkout-modal (onConfirm)="finalizeOrder()"></app-checkout-modal>